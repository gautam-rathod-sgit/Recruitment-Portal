@{
    ViewData["Title"] = "Home Page";
}

@if (ViewData["msg"] != null)
{
    <script>window.onload = function () { alert("@ViewData["msg"] already Applied !!") }</script>
}
@if (ViewBag.status != null)
{
    <script>window.onload = function () { alert("@ViewBag.status") }</script>
}

<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        <i class="fa fa-info-circle"></i>Available Jobs
    </h1>
</section>

<!-- Main content -->
<section class="content">
    <div class="row">
        <div class="box">
            <!-- /.box-header -->
            <div class="box-body">
                <div class="col-sm-12">
                    <table id="datatable" class="table table-bordered table-striped dataTable" role="grid">
                        <thead>
                            <tr>
                                <th width="100px" class="text-center"></th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
        <!-- /.box-body -->
    </div>
</section>
<!-- /.content -->

<script>
    $(function () {
        bindDatatable();
        $("#job_ID").click(function () {
            var url = '@Url.Content("~/")' + "Home/GetEncryptedID";
            var ddlsource = $('select[name="Jobid"]').val();
                $.get(url, { Id: $(ddlsource).val() }, function (data) {
                $("#job_ID").val() = data;
            });
        });
    });

    function bindDatatable() {
        $('#datatable').DataTable({
            select: false,
            searching: false,
            ordering: false,
            lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]],
            processing: true,
            serverSide: true,
            paging: true,
            pagingType: "simple_numbers",
            bDestroy: true,
            bLengthChange: false,
            pageLength:15,
            bInfo:false,
            language: {
                "processing": "Loading",
                "infoEmpty": "No Records Found",
                "zeroRecords": "No Records Found",
                "lengthMenu": "Display _MENU_ records",
                paginate: {
                    first: '«',
                    previous: '‹',
                    next: '›',
                    last: '»'
                }
            },
            "ajax":{
                "url": "@Url.Action("GetJobsList", "Home")",
                "type": "GET",
                "datatype": "json"
            },
            "columns": [
                {
                    "sClass": "text-center",
                    "mRender": function (data, type, row) {
                        var download = '<div class="col-md-12">'
	                                    + '    <div class="box box-warning">'
		                                + '        <div class="box-header with-border">'
                                        + '            <h3 class="box-title"><strong><i class="fa fa-book margin-r-5"></i></strong>' + row.job_title +'</h3>'
		                                + '        </div>'
		                                + '        <div class="form-horizontal">'
			                            + '            <div class="box-body">'
				                        + '                <div class="form-group">'
					                    + '                    <label class="col-sm-2"><strong><i class="fa fa-map-marker margin-r-5"></i> Location: </strong></label>'
					                    + '                    <div class="col-sm-10">' + row.location +'</div>'
				                        + '                </div>'
				                        + '                <div class="form-group">'
					                    + '                    <label class="col-sm-2"><strong><i class="fa fa-book margin-r-5"></i>Criteria: </strong></label>'
					                    + '                    <div class="col-sm-10">' + row.eligibility_criteria + '</div>'
				                        + '                </div>'
				                        + '                <div class="form-group">'
					                    + '                    <label class="col-sm-2"><strong><i class="fa fa-book margin-r-5"></i>Experience: </strong></label>'
                                        + '                    <div class="col-sm-10">' + row.experience + '</div>'
				                        + '                </div>'
				                        + '                <div class="form-group">'
					                    + '                    <label class="col-sm-2"><strong><i class="fa fa-book margin-r-5"></i>Role: </strong></label>'
                                        + '                    <div class="col-sm-10">'+ row.job_role + '</div>'
				                        + '                </div>'
				                        + '                <div class="form-group">'
					                    + '                    <label class="col-sm-2"><strong><i class="fa fa-book margin-r-5"></i>Type: </strong></label>'
                                        + '                    <div class="col-sm-10">' + row.job_type + '</div>'
				                        + '                </div>'
				                        + '                <div class="form-group">'
					                    + '                    <label class="col-sm-2"><strong><i class="fa fa-book margin-r-5"></i>Vacancy: </strong></label>'
                                        + '                    <div class="col-sm-10">' + row.vacancy + '</div>'
				                        + '                </div>'
				                        + '                <div class="form-group">'
					                    + '                    <label class="col-sm-2"><strong><i class="fa fa-book margin-r-5"></i>Required Skills: </strong></label>'
					                    + '                    <div class="col-sm-10">' + row.skills  +'</div>'
				                        + '                </div>'
			                            + '            </div>'
                                        + '            <div class="box-footer">'
                                        + '                <a href = "#" title = "Apply" class="btn btn-info" onclick = "applyforJob(\'' + row.EncryptionId + '\')">Apply</a>'
			                            + '            </div>'
		                                + '        </div>'
	                                    + '    </div>'
                                        + '</div>'
                        return download;
                    }
                },
            ],
            "order": [[0, "asc"]]
        });
    }

    function applyforJob(Jobid) {
        window.location.href = '@Url.Action("Index", "Candidate")?Jobid=' + Jobid;
    }
</script>